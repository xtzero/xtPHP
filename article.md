# 搞一个框架出来
## 今天搞什么
首先明确今天要搞的事情：搞一个PHP的简易框架出来。

## 需求分析
既然要搞一个框架，首先需要明确，搞出来这个框架要满足什么要求。

这个框架，只想用它来写接口。接受前端的请求，返回给前端数据。

让接口按照功能分类，存放在不同的文件中。

提供统一的数据库入口和程序入口。

提供统一的公共函数库。

## 实现

### 文件结构
根目录下放接口要访问的文件。`/lib`下放框架相关的文件。

框架相关的文件需要：函数库、数据库类、模型类、入口控制器。

+ `/lib/common.php`是函数库。
+ `/lib/db.php`是数据库类。
+ `/lib/dbUtil.php`是模型类。
+ `/lib/entry.php`是入口控制器。

### 各模块之间怎么联系起来

+ 所有接口文件都要引入`/lib/entry.php`文件。
+ 所有的接口文件都要继承主控制器，即`/lib/entry.php`中的`entry`类。
+ 主控制器负责引入类库和函数库。
+ 所有接口文件末尾使用公共函数库提供的`runApp`方法启动当前程序。

### 控制器
每一个根目录下的php文件对应一个单独的控制器，一个控制器中包含一系列同一类的方法。为实现部分方法作为接口面向前端，控制器下的所有除了`run`的方法都定义为`private`，在`run`方法中使用数组登记的方式进行限制。

前端直接访问具体的一个php文件，使用`method`参数来指定访问哪一个方法。

主控制器下提供了一系列的方法，具体参照文档。

### 数据库类
数据库类使用单例模式，负责保存数据库账户信息，并提供唯一的数据库连接。

只需要支持单数据库服务器单数据库。

### 模型类
所有的模型类都放在统一的模型文件`/lib/dbUtil.php`中。在使用方便的前提下，模型类下的所有方法都定义为静态`static`。

### 函数库
函数库是`/lib/common.php`文件。这个文件在`lib/entry.php`中被引入，因此该文件下所有函数都可以在程序的任何位置使用。

公共函数库提供几个默认方法。例如跨域访问、向前端返回数据包、显示错误信息等。

为轻便起见，不区分用户的公共函数库与系统的函数库，只注重“全局”。所有全局可用的函数，都写在这个文件中。

## github地址
![](data:image/png;base64,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)